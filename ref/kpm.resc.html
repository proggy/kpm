
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><title>Python: module kpm.resc</title>
</head><body bgcolor="#f0f0f8">

<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="heading">
<tr bgcolor="#7799ee">
<td valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial">&nbsp;<br><big><big><strong><a href="kpm.html"><font color="#ffffff">kpm</font></a>.resc</strong></big></big></font></td
><td align=right valign=bottom
><font color="#ffffff" face="helvetica, arial"><a href=".">index</a><br><a href="file:/home/djung/lib/kpm/resc.so">/home/djung/lib/kpm/resc.so</a></font></td></tr></table>
    <p><tt>Rescale&nbsp;matrix&nbsp;so&nbsp;that&nbsp;its&nbsp;spectrum&nbsp;fits&nbsp;into&nbsp;the&nbsp;interval&nbsp;[-1,&nbsp;1].&nbsp;Also,<br>
rescale&nbsp;the&nbsp;results&nbsp;obtained&nbsp;by&nbsp;the&nbsp;kernel&nbsp;polynomial&nbsp;method&nbsp;back&nbsp;to&nbsp;the<br>
original&nbsp;spectrum.<br>
&nbsp;<br>
To&nbsp;do:<br>
--&gt;&nbsp;support&nbsp;other&nbsp;matrix&nbsp;formats&nbsp;besides&nbsp;CSR&nbsp;(e.g.&nbsp;dense&nbsp;matrices)<br>
--&gt;&nbsp;support&nbsp;expansions&nbsp;in&nbsp;more&nbsp;than&nbsp;one&nbsp;variable&nbsp;(multivariate&nbsp;functions)<br>
&nbsp;<br>
Background:&nbsp;The&nbsp;kernel&nbsp;polynomial&nbsp;method&nbsp;(KPM)&nbsp;[1]&nbsp;uses&nbsp;a&nbsp;series&nbsp;expansion<br>
technique&nbsp;using&nbsp;Chebychev&nbsp;polynomials.&nbsp;These&nbsp;polynomials&nbsp;are&nbsp;defined&nbsp;only<br>
on&nbsp;the&nbsp;interval&nbsp;[-1,&nbsp;1].<br>
&nbsp;<br>
[1]&nbsp;Weiße&nbsp;et&nbsp;al.,&nbsp;Rev.&nbsp;Mod.&nbsp;Phys.&nbsp;78,&nbsp;275&nbsp;(2006)</tt></p>
<p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#aa55cc">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Modules</strong></big></font></td></tr>
    
<tr><td bgcolor="#aa55cc"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><table width="100%" summary="list"><tr><td width="25%" valign=top><a href="__builtin__.html">__builtin__</a><br>
<a href="cofunc.html">cofunc</a><br>
</td><td width="25%" valign=top><a href="kpm.misc.html">kpm.misc</a><br>
<a href="numpy.html">numpy</a><br>
</td><td width="25%" valign=top><a href="scipy.html">scipy</a><br>
</td><td width="25%" valign=top></td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#eeaa77">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Functions</strong></big></font></td></tr>
    
<tr><td bgcolor="#eeaa77"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><dl><dt><a name="-erange2params"><strong>erange2params</strong></a>(...)</dt><dd><tt>a,&nbsp;b&nbsp;=&nbsp;<a href="#-erange2params">erange2params</a>(erange,&nbsp;eps=0.)<br>
&nbsp;<br>
Calculate&nbsp;the&nbsp;scaling&nbsp;parameters&nbsp;"a"&nbsp;and&nbsp;"b"&nbsp;from&nbsp;the&nbsp;given&nbsp;energy&nbsp;range<br>
(2-tuple),&nbsp;like&nbsp;a=(emax-emin)/(2-eps)&nbsp;and&nbsp;b=(emax+emin)/2,&nbsp;where&nbsp;(emin,<br>
emax)&nbsp;is&nbsp;the&nbsp;given&nbsp;energy&nbsp;range&nbsp;"erange".&nbsp;An&nbsp;additional&nbsp;small&nbsp;number&nbsp;"eps"<br>
can&nbsp;be&nbsp;specified&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;the&nbsp;spectrum&nbsp;lies&nbsp;well&nbsp;inside&nbsp;the&nbsp;chosen<br>
energy&nbsp;range.&nbsp;For&nbsp;the&nbsp;Jackson&nbsp;kernel&nbsp;(see&nbsp;the&nbsp;submodule&nbsp;"kern"),<br>
eps=pi/limit&nbsp;is&nbsp;said&nbsp;to&nbsp;be&nbsp;an&nbsp;excellent&nbsp;choice&nbsp;[1],&nbsp;where&nbsp;limit&nbsp;is&nbsp;the<br>
number&nbsp;of&nbsp;moments&nbsp;(truncation&nbsp;limit)&nbsp;of&nbsp;the&nbsp;Chebychev&nbsp;expansion.<br>
&nbsp;<br>
[1]&nbsp;Weiße&nbsp;et&nbsp;al.,&nbsp;Rev.&nbsp;Mod.&nbsp;Phys.&nbsp;78,&nbsp;275&nbsp;(2006).</tt></dd></dl>
 <dl><dt><a name="-get_erange"><strong>get_erange</strong></a>(...)</dt><dd><tt>emin,&nbsp;emax&nbsp;=&nbsp;<a href="#-get_erange">get_erange</a>(mat,&nbsp;extra=0.)<br>
&nbsp;<br>
If&nbsp;the&nbsp;(energy)&nbsp;spectrum&nbsp;of&nbsp;the&nbsp;(tight&nbsp;binding)&nbsp;matrix&nbsp;is&nbsp;completely<br>
unknown,&nbsp;this&nbsp;function&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;estimate&nbsp;the&nbsp;highest&nbsp;and&nbsp;lowest<br>
(energy)&nbsp;eigenvalue&nbsp;by&nbsp;means&nbsp;of&nbsp;the&nbsp;Lanczos&nbsp;algorithm.&nbsp;(However,&nbsp;most&nbsp;of<br>
the&nbsp;time&nbsp;one&nbsp;should&nbsp;have&nbsp;a&nbsp;fairly&nbsp;good&nbsp;idea&nbsp;of&nbsp;the&nbsp;(energy)&nbsp;range&nbsp;already<br>
from&nbsp;the&nbsp;model&nbsp;that&nbsp;is&nbsp;used.)<br>
&nbsp;<br>
A&nbsp;small&nbsp;factor&nbsp;"extra"&nbsp;may&nbsp;be&nbsp;given,&nbsp;the&nbsp;returned&nbsp;(energy)&nbsp;range&nbsp;is<br>
enlarged&nbsp;by&nbsp;that&nbsp;factor&nbsp;to&nbsp;be&nbsp;sure&nbsp;that&nbsp;the&nbsp;whole&nbsp;(energy)&nbsp;spectrum&nbsp;of&nbsp;the<br>
given&nbsp;matrix&nbsp;is&nbsp;really&nbsp;contained&nbsp;in&nbsp;the&nbsp;returned&nbsp;range.</tt></dd></dl>
 <dl><dt><a name="-inverse_rescale"><strong>inverse_rescale</strong></a>(...)</dt><dd><tt>new_disc&nbsp;=&nbsp;<a href="#-inverse_rescale">inverse_rescale</a>(disc,&nbsp;params)<br>
&nbsp;<br>
Scale&nbsp;the&nbsp;x-axis&nbsp;(discretization&nbsp;axis)&nbsp;of&nbsp;the&nbsp;quantity&nbsp;that&nbsp;has&nbsp;been<br>
calculated&nbsp;with&nbsp;the&nbsp;kernel&nbsp;polynomial&nbsp;method&nbsp;back&nbsp;to&nbsp;its&nbsp;original&nbsp;energy<br>
range.&nbsp;"params"&nbsp;is&nbsp;expecting&nbsp;a&nbsp;2-tuple,&nbsp;containing&nbsp;the&nbsp;scaling&nbsp;parameters<br>
"a"&nbsp;and&nbsp;"b"&nbsp;that&nbsp;have&nbsp;been&nbsp;used&nbsp;before&nbsp;to&nbsp;rescale&nbsp;the&nbsp;matrix.<br>
&nbsp;<br>
The&nbsp;given&nbsp;discretization&nbsp;array&nbsp;"disc"&nbsp;is&nbsp;inversly&nbsp;rescaled&nbsp;like&nbsp;disc*a+b.</tt></dd></dl>
 <dl><dt><a name="-inverse_rescale_density"><strong>inverse_rescale_density</strong></a>(...)</dt><dd><tt>new_energ,&nbsp;new_dens&nbsp;=&nbsp;<a href="#-inverse_rescale_density">inverse_rescale_density</a>(energ,&nbsp;dens,&nbsp;params)<br>
&nbsp;<br>
Special&nbsp;case&nbsp;for&nbsp;densities&nbsp;that&nbsp;are&nbsp;calculated&nbsp;with&nbsp;the&nbsp;kernel&nbsp;polynomial<br>
method&nbsp;[1],&nbsp;where&nbsp;not&nbsp;only&nbsp;the&nbsp;energy&nbsp;axis&nbsp;(discretization)&nbsp;is&nbsp;scaled&nbsp;back<br>
to&nbsp;the&nbsp;original&nbsp;energy&nbsp;range&nbsp;of&nbsp;the&nbsp;matrix&nbsp;spectrum,&nbsp;but&nbsp;also&nbsp;the&nbsp;density<br>
itself&nbsp;is&nbsp;devided&nbsp;by&nbsp;the&nbsp;parameter&nbsp;"a",&nbsp;so&nbsp;that&nbsp;the&nbsp;density&nbsp;keeps<br>
its&nbsp;normalization.</tt></dd></dl>
 <dl><dt><a name="-inverse_rescale_density_cofunc"><strong>inverse_rescale_density_cofunc</strong></a>(...)</dt><dd><tt>new_cofunc&nbsp;=&nbsp;<a href="#-inverse_rescale_density_cofunc">inverse_rescale_density_cofunc</a>(cofunc,&nbsp;params)<br>
&nbsp;<br>
Same&nbsp;as&nbsp;"inverse_rescale_density",&nbsp;but&nbsp;accepts&nbsp;and&nbsp;returns&nbsp;a<br>
cofunc.coFunc&nbsp;object&nbsp;from&nbsp;the&nbsp;cofunc-module.</tt></dd></dl>
 <dl><dt><a name="-rescale"><strong>rescale</strong></a>(...)</dt><dd><tt>mat,&nbsp;(a,&nbsp;b)&nbsp;=&nbsp;<a href="#-rescale">rescale</a>(mat,&nbsp;erange=None,&nbsp;params=None,&nbsp;omp=True,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_threads=None,&nbsp;eps=0.,&nbsp;copy=True)<br>
a,&nbsp;b&nbsp;=&nbsp;<a href="#-rescale">rescale</a>(mat,&nbsp;erange=None,&nbsp;params=None,&nbsp;omp=True,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_threads=None,&nbsp;eps=0.,&nbsp;copy=False)<br>
&nbsp;<br>
Rescale&nbsp;the&nbsp;given&nbsp;matrix&nbsp;in-place.&nbsp;Specify&nbsp;either&nbsp;an&nbsp;energy&nbsp;range&nbsp;"erange"<br>
(2-tuple)&nbsp;or&nbsp;directly&nbsp;the&nbsp;scaling&nbsp;parameters&nbsp;"params"&nbsp;(2-tuple).&nbsp;If&nbsp;"omp"<br>
is&nbsp;True,&nbsp;use&nbsp;parallel&nbsp;for-loops&nbsp;(OpenMP).&nbsp;If&nbsp;"num_threads"&nbsp;is&nbsp;not&nbsp;None,&nbsp;set<br>
the&nbsp;number&nbsp;of&nbsp;threads.&nbsp;If&nbsp;the&nbsp;number&nbsp;of&nbsp;threads&nbsp;is&nbsp;smaller&nbsp;than&nbsp;1,<br>
determine&nbsp;and&nbsp;use&nbsp;the&nbsp;number&nbsp;of&nbsp;processor&nbsp;cores.<br>
&nbsp;<br>
The&nbsp;matrix&nbsp;will&nbsp;be&nbsp;rescaled&nbsp;in-place&nbsp;like&nbsp;mat=(mat-b)/a,&nbsp;if&nbsp;a&nbsp;and&nbsp;b&nbsp;are&nbsp;the<br>
two&nbsp;scaling&nbsp;parameters.&nbsp;Instead&nbsp;of&nbsp;the&nbsp;parameters&nbsp;itself,&nbsp;an&nbsp;energy&nbsp;range<br>
can&nbsp;be&nbsp;specified.&nbsp;The&nbsp;eigenspectrum&nbsp;of&nbsp;the&nbsp;matrix&nbsp;should&nbsp;fit&nbsp;well&nbsp;into&nbsp;the<br>
given&nbsp;energy&nbsp;range.&nbsp;The&nbsp;scaling&nbsp;parameters&nbsp;are&nbsp;then&nbsp;calculated&nbsp;via<br>
a=(emax-emin)/(2-eps)&nbsp;and&nbsp;b=(emax+emin)/2,&nbsp;where&nbsp;(emin,&nbsp;emax)&nbsp;is&nbsp;the&nbsp;given<br>
energy&nbsp;range.&nbsp;An&nbsp;additional&nbsp;small&nbsp;number&nbsp;"eps"&nbsp;can&nbsp;be&nbsp;specified&nbsp;to&nbsp;get&nbsp;sure<br>
that&nbsp;the&nbsp;spectrum&nbsp;lies&nbsp;well&nbsp;inside&nbsp;the&nbsp;chosen&nbsp;energy&nbsp;range.&nbsp;For&nbsp;the&nbsp;Jackson<br>
kernel&nbsp;(see&nbsp;the&nbsp;submodule&nbsp;"kern"),&nbsp;eps=pi/limit&nbsp;is&nbsp;said&nbsp;to&nbsp;be&nbsp;an&nbsp;excellent<br>
choice&nbsp;[1],&nbsp;where&nbsp;limit&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;moments&nbsp;(truncation&nbsp;limit)&nbsp;of&nbsp;the<br>
Chebychev&nbsp;expansion.<br>
&nbsp;<br>
This&nbsp;function&nbsp;delegates&nbsp;the&nbsp;actual&nbsp;work&nbsp;to&nbsp;one&nbsp;of&nbsp;the&nbsp;low-level&nbsp;functions,<br>
all&nbsp;beginning&nbsp;with&nbsp;"_rescale_",&nbsp;depending&nbsp;on&nbsp;the&nbsp;matrix&nbsp;type,&nbsp;data&nbsp;type&nbsp;and<br>
OpenMP-parallelization&nbsp;requirements.&nbsp;If&nbsp;no&nbsp;appropriate&nbsp;low-level&nbsp;function<br>
is&nbsp;found,&nbsp;then&nbsp;the&nbsp;plain&nbsp;Python&nbsp;implementation&nbsp;"_rescale"&nbsp;is&nbsp;used.<br>
&nbsp;<br>
[1]&nbsp;Weiße&nbsp;et&nbsp;al.,&nbsp;Rev.&nbsp;Mod.&nbsp;Phys.&nbsp;78,&nbsp;275&nbsp;(2006).</tt></dd></dl>
</td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#55aa55">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Data</strong></big></font></td></tr>
    
<tr><td bgcolor="#55aa55"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><strong>__created__</strong> = '2012-08-06'<br>
<strong>__modified__</strong> = '2012-10-09'<br>
<strong>__test__</strong> = {}</td></tr></table>
</body></html>